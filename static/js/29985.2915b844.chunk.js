"use strict";(self.webpackChunkn2_tree=self.webpackChunkn2_tree||[]).push([[29985,39323],{39323:(e,a,t)=>{t.d(a,{L:()=>u});var n=t(55171),r=t(3825),i=t(50076),l=t(50346),s=t(13096),o=t(24883),d=t(98662);async function u(e,a){const t=(0,s.qg)(e);if(!t)throw new i.default("invalid-url","Invalid scene service url");const u={...a,sceneServerUrl:t.url.path,layerId:t.sublayer??void 0};if(u.sceneLayerItem??=await async function(e){const a=(await y(e)).serviceItemId;if(!a)return null;const t=new d.default({id:a,apiKey:e.apiKey}),i=await async function(e){const a=n.id?.findServerInfo(e.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;const t=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await(0,r.default)(t,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(f){(0,l.throwIfAbortError)(f)}return null}(e);null!=i&&(t.portal=new o.default({url:i}));try{return await t.load({signal:e.signal})}catch(h){return(0,l.throwIfAbortError)(h),null}}(u),null==u.sceneLayerItem)return c(u.sceneServerUrl.replace("/SceneServer","/FeatureServer"),u);const f=await async function(e){let{sceneLayerItem:a,signal:t}=e;if(!a)return null;try{const e=(await a.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:t})).find((e=>"Feature Service"===e.type))||null;if(!e)return null;const n=new d.default({portal:e.portal,id:e.id});return await n.load(),n}catch(n){return(0,l.throwIfAbortError)(n),null}}(u);if(!f?.url)throw new i.default("related-service-not-found","Could not find feature service through portal item relationship");u.featureServiceItem=f;const h=await c(f.url,u);return h.portalItem=f,h}async function y(e){if(e.rootDocument)return e.rootDocument;const a={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{const t=await(0,r.default)(e.sceneServerUrl,a);e.rootDocument=t.data}catch{e.rootDocument={}}return e.rootDocument}async function c(e,a){const t=(0,s.qg)(e);if(!t)throw new i.default("invalid-feature-service-url","Invalid feature service url");const n=t.url.path,l=a.layerId;if(null==l)return{serverUrl:n};const o=y(a),d=a.featureServiceItem?await a.featureServiceItem.fetchData("json"):null,u=(d?.layers?.[0]||d?.tables?.[0])?.customParameters,c=e=>{const t={query:{f:"json",...u},responseType:"json",authMode:e,signal:a.signal};return(0,r.default)(n,t)},f=c("anonymous").catch((()=>c("no-prompt"))),[h,w]=await Promise.all([f,o]),m=w?.layers,b=h.data&&h.data.layers;if(!Array.isArray(b))throw new Error("expected layers array");if(Array.isArray(m)){for(let r=0;r<Math.min(m.length,b.length);r++)if(m[r].id===l)return{serverUrl:n,layerId:b[r].id}}else if(null!=l&&l<b.length)return{serverUrl:n,layerId:b[l].id};throw new Error("could not find matching associated sublayer")}},62487:(e,a,t)=>{t.d(a,{S:()=>n});const n={BingMapsLayer:async()=>(await t.e(88685).then(t.bind(t,11066))).default,BuildingSceneLayer:async()=>(await Promise.all([t.e(21729),t.e(59231),t.e(74279),t.e(57236),t.e(90260),t.e(9297)]).then(t.bind(t,62690))).default,CSVLayer:async()=>(await t.e(1365).then(t.bind(t,1365))).default,CatalogLayer:async()=>(await Promise.all([t.e(98618),t.e(89122),t.e(65211),t.e(38911),t.e(30177),t.e(72011)]).then(t.bind(t,72011))).default,DimensionLayer:async()=>(await t.e(25342).then(t.bind(t,25342))).default,ElevationLayer:async()=>(await t.e(23875).then(t.bind(t,23875))).default,FeatureLayer:async()=>(await Promise.resolve().then(t.bind(t,30907))).default,GeoJSONLayer:async()=>(await t.e(50709).then(t.bind(t,50709))).default,GeoRSSLayer:async()=>(await t.e(52551).then(t.bind(t,52551))).default,GroupLayer:async()=>(await Promise.all([t.e(16095),t.e(11668)]).then(t.bind(t,16095))).default,ImageryLayer:async()=>(await Promise.all([t.e(89122),t.e(99846),t.e(93187),t.e(6745),t.e(46570),t.e(5640),t.e(82178),t.e(90391),t.e(74014),t.e(65135)]).then(t.bind(t,85598))).default,ImageryTileLayer:async()=>(await Promise.all([t.e(99846),t.e(93187),t.e(6745),t.e(46570),t.e(5640),t.e(59844),t.e(82178),t.e(76562),t.e(31031),t.e(33562),t.e(34214)]).then(t.bind(t,33562))).default,IntegratedMesh3DTilesLayer:async()=>(await t.e(76790).then(t.bind(t,76790))).default,IntegratedMeshLayer:async()=>(await Promise.all([t.e(90260),t.e(87983)]).then(t.bind(t,35950))).default,KMLLayer:async()=>(await t.e(37546).then(t.bind(t,15165))).default,KnowledgeGraphLayer:async()=>(await Promise.all([t.e(98618),t.e(85646),t.e(98683),t.e(48094),t.e(82816),t.e(57162),t.e(26267),t.e(55),t.e(61650),t.e(12718),t.e(26570)]).then(t.bind(t,26570))).default,LineOfSightLayer:async()=>(await Promise.all([t.e(21729),t.e(94228),t.e(86490)]).then(t.bind(t,86490))).default,LinkChartLayer:async()=>(await Promise.all([t.e(98618),t.e(85646),t.e(98683),t.e(48094),t.e(82816),t.e(57162),t.e(26267),t.e(55),t.e(61650),t.e(12718),t.e(17079)]).then(t.bind(t,17079))).default,MapImageLayer:async()=>(await Promise.all([t.e(98618),t.e(89122),t.e(65211),t.e(39568),t.e(82951)]).then(t.bind(t,82951))).default,MapNotesLayer:async()=>(await t.e(43311).then(t.bind(t,43311))).default,MediaLayer:async()=>(await Promise.all([t.e(63533),t.e(4056)]).then(t.bind(t,76758))).default,OGCFeatureLayer:async()=>(await Promise.all([t.e(98618),t.e(17141),t.e(69548)]).then(t.bind(t,1741))).default,OpenStreetMapLayer:async()=>(await t.e(50803).then(t.bind(t,50803))).default,OrientedImageryLayer:async()=>(await t.e(13014).then(t.bind(t,13014))).default,PointCloudLayer:async()=>(await Promise.all([t.e(90260),t.e(74497)]).then(t.bind(t,60964))).default,RouteLayer:async()=>(await Promise.all([t.e(98815),t.e(37810),t.e(25925)]).then(t.bind(t,25925))).default,SceneLayer:async()=>(await Promise.all([t.e(21729),t.e(59231),t.e(74279),t.e(90260),t.e(95049)]).then(t.bind(t,58029))).default,StreamLayer:async()=>(await t.e(84369).then(t.bind(t,84369))).default,SubtypeGroupLayer:async()=>(await t.e(89645).then(t.bind(t,89645))).default,TileLayer:async()=>(await Promise.all([t.e(98618),t.e(89122),t.e(65211),t.e(39568),t.e(71174)]).then(t.bind(t,71174))).default,UnknownLayer:async()=>(await t.e(8896).then(t.bind(t,8896))).default,UnsupportedLayer:async()=>(await t.e(72043).then(t.bind(t,72043))).default,VectorTileLayer:async()=>(await Promise.all([t.e(45995),t.e(93222)]).then(t.bind(t,53451))).default,VideoLayer:async()=>(await Promise.all([t.e(80782),t.e(85270)]).then(t.bind(t,79426))).default,ViewshedLayer:async()=>(await Promise.all([t.e(21729),t.e(11288)]).then(t.bind(t,80391))).default,VoxelLayer:async()=>(await Promise.all([t.e(90260),t.e(32470)]).then(t.bind(t,31879))).default,WCSLayer:async()=>(await Promise.all([t.e(99846),t.e(93187),t.e(6745),t.e(46570),t.e(5640),t.e(59844),t.e(82178),t.e(76562),t.e(31031),t.e(36164),t.e(60540)]).then(t.bind(t,60540))).default,WFSLayer:async()=>(await Promise.all([t.e(11316),t.e(96087)]).then(t.bind(t,26964))).default,WMSLayer:async()=>(await t.e(52908).then(t.bind(t,52908))).default,WMTSLayer:async()=>(await t.e(97793).then(t.bind(t,97793))).default,WebTileLayer:async()=>(await t.e(24552).then(t.bind(t,24552))).default}}}]);
//# sourceMappingURL=29985.2915b844.chunk.js.map