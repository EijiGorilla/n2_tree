{"version":3,"file":"static/js/39323.be3758ca.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/associatedFeatureServiceUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{id as e}from\"../../kernel.js\";import r from\"../../request.js\";import t from\"../../core/Error.js\";import{throwIfAbortError as n}from\"../../core/promiseUtils.js\";import{parse as a}from\"./arcgisLayerUrl.js\";import o from\"../../portal/Portal.js\";import i from\"../../portal/PortalItem.js\";async function s(e,r){const n=a(e);if(!n)throw new t(\"invalid-url\",\"Invalid scene service url\");const o={...r,sceneServerUrl:n.url.path,layerId:n.sublayer??void 0};if(o.sceneLayerItem??=await l(o),null==o.sceneLayerItem)return f(o.sceneServerUrl.replace(\"/SceneServer\",\"/FeatureServer\"),o);const i=await y(o);if(!i?.url)throw new t(\"related-service-not-found\",\"Could not find feature service through portal item relationship\");o.featureServiceItem=i;const s=await f(i.url,o);return s.portalItem=i,s}async function l(e){const r=(await c(e)).serviceItemId;if(!r)return null;const t=new i({id:r,apiKey:e.apiKey}),a=await u(e);null!=a&&(t.portal=new o({url:a}));try{return await t.load({signal:e.signal})}catch(s){return n(s),null}}async function c(e){if(e.rootDocument)return e.rootDocument;const t={query:{f:\"json\",...e.customParameters,token:e.apiKey},responseType:\"json\",signal:e.signal};try{const n=await r(e.sceneServerUrl,t);e.rootDocument=n.data}catch{e.rootDocument={}}return e.rootDocument}async function u(t){const a=e?.findServerInfo(t.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;const o=t.sceneServerUrl.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";try{const e=(await r(o,{query:{f:\"json\"},responseType:\"json\",signal:t.signal})).data.owningSystemUrl;if(e)return e}catch(i){n(i)}return null}async function f(e,n){const o=a(e);if(!o)throw new t(\"invalid-feature-service-url\",\"Invalid feature service url\");const i=o.url.path,s=n.layerId;if(null==s)return{serverUrl:i};const l=c(n),u=n.featureServiceItem?await n.featureServiceItem.fetchData(\"json\"):null,f=(u?.layers?.[0]||u?.tables?.[0])?.customParameters,y=e=>{const t={query:{f:\"json\",...f},responseType:\"json\",authMode:e,signal:n.signal};return r(i,t)},m=y(\"anonymous\").catch((()=>y(\"no-prompt\"))),[p,d]=await Promise.all([m,l]),v=d?.layers,w=p.data&&p.data.layers;if(!Array.isArray(w))throw new Error(\"expected layers array\");if(Array.isArray(v))for(let r=0;r<Math.min(v.length,w.length);r++){if(v[r].id===s)return{serverUrl:i,layerId:w[r].id}}else if(null!=s&&s<w.length)return{serverUrl:i,layerId:w[s].id};throw new Error(\"could not find matching associated sublayer\")}async function y({sceneLayerItem:e,signal:r}){if(!e)return null;try{const t=(await e.fetchRelatedItems({relationshipType:\"Service2Service\",direction:\"reverse\"},{signal:r})).find((e=>\"Feature Service\"===e.type))||null;if(!t)return null;const n=new i({portal:t.portal,id:t.id});return await n.load(),n}catch(t){return n(t),null}}export{s as findAssociatedFeatureService};\n"],"names":["async","s","e","r","n","a","t","o","sceneServerUrl","url","path","layerId","sublayer","sceneLayerItem","c","serviceItemId","i","id","apiKey","findServerInfo","owningSystemUrl","replace","query","f","responseType","signal","data","u","portal","load","l","_ref","fetchRelatedItems","relationshipType","direction","find","type","y","featureServiceItem","portalItem","rootDocument","customParameters","token","serverUrl","fetchData","layers","tables","authMode","m","catch","p","d","Promise","all","v","w","Array","isArray","Error","Math","min","length"],"sourceRoot":""}